
* Methodology

- Evaluation was done on a machine with an AMD and 64GB of RAM.
- CPU boosting was disabled in order to avoid thermal throttling.
- The benchmarks were run with a minimal amount of other applications running.
- Time measurements are the averages of 10 runs.

* WebAssembly

** Node

*** --coalesce-locals

**** start up time
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     3 |     3 |        2 |      12 |      11 |     3 |    18 |        8 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     3 |     3 |        3 |      12 |      12 |     3 |    15 |        5 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     3 |     2 |        3 |       4 |       4 |     3 |    15 |        7 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     3 |     3 |        3 |       5 |       4 |     3 |    14 |        4 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     3 |     2 |        2 |       4 |       4 |     4 |    16 |        4 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     3 |     3 |        3 |       4 |       4 |     3 |     9 |        4 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     3 |     3 |        2 |       4 |       4 |     3 |     7 |        4 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  |       |       |          |         |         |       |       |          |

***** latex
#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 3 & 3 & 2 & 12 & 11 & 3 & 18 & 8\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 3 & 3 & 3 & 12 & 12 & 3 & 15 & 5\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 3 & 2 & 3 & 4 & 4 & 3 & 15 & 7\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 3 & 3 & 3 & 5 & 4 & 3 & 14 & 4\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 3 & 2 & 2 & 4 & 4 & 4 & 16 & 4\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 3 & 3 & 3 & 4 & 4 & 3 & 9 & 4\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 3 & 3 & 2 & 4 & 4 & 3 & 7 & 4\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** run time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     3 |     0 |        1 |      57 |     522 |    22 |   584 |      430 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     3 |     1 |        1 |      53 |     465 |    21 |   522 |      219 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     3 |     1 |        0 |      28 |      97 |    22 |   379 |      422 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     3 |     0 |        1 |      24 |      86 |    22 |   306 |      188 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     3 |     1 |        1 |      24 |      86 |    22 |   505 |      190 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     2 |     0 |        0 |      23 |      87 |    21 |   298 |      188 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     2 |     0 |        1 |      22 |      92 |    16 |   168 |      112 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex
#+BEGIN_SRC latex
  \begin{table}
  \caption{placeholder caption}
  \label{tbl:placeholder-label}
  \centering
  \begin{tabular}{|l|r|r|r|r|r|r|r|r|}
  \hline
   & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
  CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 3 & 0 & 1 & 57 & 522 & 22 & 584 & 430\\ 
  \hline
  CPS, inserted tailcalls (no return instrs) (feb-13-24) & 3 & 1 & 1 & 53 & 465 & 21 & 522 & 219\\ 
  \hline
  non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 3 & 1 & 0 & 28 & 97 & 22 & 379 & 422\\ 
  \hline
  non-CPS, with return instrs, 0ary fast (feb-26-24) & 3 & 0 & 1 & 24 & 86 & 22 & 306 & 188\\ 
  \hline
  same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 3 & 1 & 1 & 24 & 86 & 22 & 505 & 190\\ 
  \hline
  same as (mrch-15-24), don't nest if statements (mrch-22-24) & 2 & 0 & 0 & 23 & 87 & 21 & 298 & 188\\ 
  \hline
  same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 2 & 0 & 1 & 22 & 92 & 16 & 168 & 112\\ 
  \hline
  \end{tabular}
  \end{table}
#+END_SRC

**** Mem used

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    53 |    14 |      145 |   20826 |  142740 |   504 | 95452 |    74779 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    53 |    13 |      145 |   19350 |  132743 |   464 | 92199 |    73608 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    22 |     6 |       41 |    7319 |   45943 |   288 | 19744 |    26810 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    53 |    13 |       41 |    6128 |   38141 |   248 | 92199 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex
#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 53 & 14 & 145 & 20826 & 142740 & 504 & 95452 & 74779\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 53 & 13 & 145 & 19350 & 132743 & 464 & 92199 & 73608\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 22 & 6 & 41 & 7319 & 45943 & 288 & 19744 & 26810\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 53 & 13 & 41 & 6128 & 38141 & 248 & 92199 & 25642\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** Binary size

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    67 |    11 |       11 |     569 |     572 |   346 |  1876 |      929 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    67 |    11 |       10 |     542 |     543 |   344 |  1731 |      652 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    66 |     9 |        9 |     286 |     289 |   335 |  1810 |      809 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    67 |     9 |        9 |     270 |     271 |   341 |  1706 |      540 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    69 |    11 |        9 |     270 |     271 |   341 |  1771 |      540 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    65 |     9 |        9 |     265 |     266 |   333 |  1667 |      530 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    45 |     6 |        6 |     224 |     224 |   228 |  1164 |      422 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex
#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 67 & 11 & 11 & 569 & 572 & 346 & 1876 & 929\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 67 & 11 & 10 & 542 & 543 & 344 & 1731 & 652\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 66 & 9 & 9 & 286 & 289 & 335 & 1810 & 809\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 67 & 9 & 9 & 270 & 271 & 341 & 1706 & 540\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 69 & 11 & 9 & 270 & 271 & 341 & 1771 & 540\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 65 & 9 & 9 & 265 & 266 & 333 & 1667 & 530\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 45 & 6 & 6 & 224 & 224 & 228 & 1164 & 422\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

*** -O2

**** Start up time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     3 |     3 |        2 |      12 |      12 |     3 | N/A   |        9 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     5 |     5 |        3 |      14 |      14 |     5 | N/A   |        7 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     5 |     4 |        4 |       6 |       6 |     6 | 14    |        9 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     4 |     4 |        4 |       6 |       6 |     5 | N/A   |        6 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     5 |     5 |        5 |       7 |       7 |     5 | N/A   |        6 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     4 |     4 |        5 |       6 |       6 |     5 | 12    |        6 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     5 |     5 |        5 |       6 |       6 |     5 | 9     |        5 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex
#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 3 & 3 & 2 & 12 & 12 & 3 & N/A & 9\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 5 & 5 & 3 & 14 & 14 & 5 & N/A & 7\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 5 & 4 & 4 & 6 & 6 & 6 & 14 & 9\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 4 & 4 & 4 & 6 & 6 & 5 & N/A & 6\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 5 & 5 & 5 & 7 & 7 & 5 & N/A & 6\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 4 & 4 & 5 & 6 & 6 & 5 & 12 & 6\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 5 & 5 & 5 & 6 & 6 & 5 & 9 & 5\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** Run time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     3 |     0 |        1 |      51 |     501 |    19 | N/A   |      394 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     3 |     1 |        1 |      45 |     428 |    19 | N/A   |      196 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     3 |     1 |        0 |      25 |      83 |    19 | 304   |      374 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     3 |     1 |        1 |      21 |      72 |    18 | N/A   |      180 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     3 |     1 |        1 |      21 |      72 |    18 | N/A   |      180 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     3 |     0 |        1 |      22 |      73 |    18 | 281   |      174 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     2 |     0 |        0 |      20 |      77 |    13 | 160   |      103 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex
#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 3 & 0 & 1 & 51 & 501 & 19 & N/A & 394\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 3 & 1 & 1 & 45 & 428 & 19 & N/A & 196\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 3 & 1 & 0 & 25 & 83 & 19 & 304 & 374\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 3 & 1 & 1 & 21 & 72 & 18 & N/A & 180\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 3 & 1 & 1 & 21 & 72 & 18 & N/A & 180\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 3 & 0 & 1 & 22 & 73 & 18 & 281 & 174\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 2 & 0 & 0 & 20 & 77 & 13 & 160 & 103\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** Memory used

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    53 |    14 |      145 |   20826 |  142740 |   504 | N/A   |    74779 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    53 |    13 |      145 |   19350 |  132743 |   464 | N/A   |    73608 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    22 |     6 |       41 |    7319 |   45943 |   288 | 19744 |    26810 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    22 |     5 |       41 |    6128 |   38141 |   248 | N/A   |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    53 |    13 |       41 |    6128 |   38141 |   248 | N/A   |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex

#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 53 & 14 & 145 & 20826 & 142740 & 504 & N/A & 74779\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 53 & 13 & 145 & 19350 & 132743 & 464 & N/A & 73608\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 22 & 6 & 41 & 7319 & 45943 & 288 & 19744 & 26810\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & N/A & 25642\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 53 & 13 & 41 & 6128 & 38141 & 248 & N/A & 25642\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** Binary size

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    66 |    11 |       10 |     507 |     511 |   339 | N/A   |      892 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    66 |    10 |       10 |     478 |     479 |   337 | N/A   |      561 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    65 |     9 |        9 |     268 |     271 |   330 | 1779  |      793 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    65 |     9 |        9 |     242 |     243 |   328 | N/A   |      459 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    66 |    10 |        9 |     242 |     243 |   328 | N/A   |      459 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    65 |     9 |        9 |     244 |     245 |   332 | 1630  |      463 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    45 |     6 |        6 |     203 |     203 |   227 | 1128  |      354 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex

#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 66 & 11 & 10 & 507 & 511 & 339 & N/A & 892\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 66 & 10 & 10 & 478 & 479 & 337 & N/A & 561\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 65 & 9 & 9 & 268 & 271 & 330 & 1779 & 793\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 65 & 9 & 9 & 242 & 243 & 328 & N/A & 459\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 66 & 10 & 9 & 242 & 243 & 328 & N/A & 459\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 65 & 9 & 9 & 244 & 245 & 332 & 1630 & 463\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 45 & 6 & 6 & 203 & 203 & 227 & 1128 & 354\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

** Wasmtime

*** --coalesce-locals

**** Start up time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    54 |    12 |       12 |     193 |     191 |   266 | 10083 |     4589 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    60 |    12 |       13 |     191 |     191 |   254 |  8630 |      824 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    89 |    14 |       16 |     104 |     115 |   536 | 10204 |     5635 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    83 |    13 |       14 |      95 |     104 |   513 |  8126 |     1362 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    52 |    12 |       11 |      94 |     101 |   513 |  8021 |     1367 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    82 |    11 |       14 |      93 |     106 |   504 |  8067 |     1334 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    44 |     7 |        7 |      80 |      79 |   232 |  1568 |      374 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 54 & 12 & 12 & 193 & 191 & 266 & 10083 & 4589\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 60 & 12 & 13 & 191 & 191 & 254 & 8630 & 824\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 89 & 14 & 16 & 104 & 115 & 536 & 10204 & 5635\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 83 & 13 & 14 & 95 & 104 & 513 & 8126 & 1362\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 52 & 12 & 11 & 94 & 101 & 513 & 8021 & 1367\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 82 & 11 & 14 & 93 & 106 & 504 & 8067 & 1334\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 44 & 7 & 7 & 80 & 79 & 232 & 1568 & 374\\ 
\hline
\end{tabular}
\end{table}

#+END_SRC

**** run time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     0 |     0 |        0 |      31 |     191 |    11 |   120 |      112 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     0 |     0 |        0 |      30 |     182 |    11 |   114 |      111 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     0 |     0 |        0 |      16 |     103 |    11 |    39 |       58 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     0 |     0 |        0 |      14 |      90 |    10 |    35 |       56 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     0 |     0 |        0 |      15 |      87 |    10 |   115 |       55 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     0 |     0 |        0 |      15 |      88 |    11 |    35 |       55 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     0 |     0 |        0 |      15 |      96 |    11 |    39 |       63 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 0 & 0 & 0 & 31 & 191 & 11 & 120 & 112\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 0 & 0 & 0 & 30 & 182 & 11 & 114 & 111\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 0 & 0 & 0 & 16 & 103 & 11 & 39 & 58\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 0 & 0 & 0 & 14 & 90 & 10 & 35 & 56\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 0 & 0 & 0 & 15 & 87 & 10 & 115 & 55\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 0 & 0 & 0 & 15 & 88 & 11 & 35 & 55\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 0 & 0 & 0 & 15 & 96 & 11 & 39 & 63\\ 
\hline
\end{tabular}
\end{table}

#+END_SRC


**** memory used

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    53 |    14 |      145 |   20826 |  142740 |   504 | 95452 |    74779 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    53 |    13 |      145 |   19350 |  132743 |   464 | 92199 |    73608 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    22 |     6 |       41 |    7319 |   45943 |   288 | 19744 |    26810 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    53 |    13 |       41 |    6128 |   38141 |   248 | 92199 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 53 & 14 & 145 & 20826 & 142740 & 504 & 95452 & 74779\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 53 & 13 & 145 & 19350 & 132743 & 464 & 92199 & 73608\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 22 & 6 & 41 & 7319 & 45943 & 288 & 19744 & 26810\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 53 & 13 & 41 & 6128 & 38141 & 248 & 92199 & 25642\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC


**** binary size

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    67 |    11 |       11 |     569 |     572 |   346 |  1876 |      929 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    67 |    11 |       10 |     542 |     543 |   344 |  1731 |      652 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    66 |     9 |        9 |     286 |     289 |   335 |  1810 |      809 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    67 |     9 |        9 |     270 |     271 |   341 |  1706 |      540 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    69 |    11 |        9 |     270 |     271 |   341 |  1771 |      540 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    65 |     9 |        9 |     265 |     266 |   333 |  1667 |      530 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    45 |     6 |        6 |     224 |     224 |   228 |  1164 |      422 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
\begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 67 & 11 & 11 & 569 & 572 & 346 & 1876 & 929\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 67 & 11 & 10 & 542 & 543 & 344 & 1731 & 652\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 66 & 9 & 9 & 286 & 289 & 335 & 1810 & 809\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 67 & 9 & 9 & 270 & 271 & 341 & 1706 & 540\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 69 & 11 & 9 & 270 & 271 & 341 & 1771 & 540\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 65 & 9 & 9 & 265 & 266 & 333 & 1667 & 530\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 45 & 6 & 6 & 224 & 224 & 228 & 1164 & 422\\ 
\hline
\end{tabular}
\end{table}  
#+END_SRC

*** -O2

**** Start up time
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    48 |    11 |       12 |     178 |     182 |   229 | N/A   |     5520 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    48 |    11 |       10 |     177 |     177 |   227 | N/A   |      881 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    84 |    13 |       13 |     100 |     112 |   510 | 11960 |     7214 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    83 |    11 |       12 |      92 |     103 |   515 | N/A   |     1570 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    49 |    12 |       11 |      92 |      99 |   511 | N/A   |     1555 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    82 |    11 |       11 |      93 |     103 |   505 | 8009  |     1309 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    41 |     7 |        6 |      71 |      72 |   225 | 1549  |      352 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|

***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 48 & 11 & 12 & 178 & 182 & 229 & N/A & 5520\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 48 & 11 & 10 & 177 & 177 & 227 & N/A & 881\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 84 & 13 & 13 & 100 & 112 & 510 & 11960 & 7214\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 83 & 11 & 12 & 92 & 103 & 515 & N/A & 1570\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 49 & 12 & 11 & 92 & 99 & 511 & N/A & 1555\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 82 & 11 & 11 & 93 & 103 & 505 & 8009 & 1309\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 41 & 7 & 6 & 71 & 72 & 225 & 1549 & 352\\ 
\hline
\end{tabular}
\end{table}

#+END_SRC

**** run time

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |     0 |     0 |        0 |      29 |     162 |     4 | N/A   |       95 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |     0 |     0 |        0 |      27 |     151 |     4 | N/A   |       95 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |     0 |     0 |        0 |      12 |      72 |     3 | 30    |       44 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |     0 |     0 |        0 |      11 |      65 |     4 | N/A   |       42 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |     0 |     0 |        0 |      10 |      65 |     4 | N/A   |       42 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |     0 |     0 |        0 |      11 |      64 |     4 | 26    |       41 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |     0 |     0 |        0 |      11 |      70 |     4 | 28    |       50 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 0 & 0 & 0 & 29 & 162 & 4 & N/A & 95\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 0 & 0 & 0 & 27 & 151 & 4 & N/A & 95\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 0 & 0 & 0 & 12 & 72 & 3 & 30 & 44\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 0 & 0 & 0 & 11 & 65 & 4 & N/A & 42\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 0 & 0 & 0 & 10 & 65 & 4 & N/A & 42\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 0 & 0 & 0 & 11 & 64 & 4 & 26 & 41\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 0 & 0 & 0 & 11 & 70 & 4 & 28 & 50\\ 
\hline
\end{tabular}
\end{table}

#+END_SRC


**** memory used

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    53 |    14 |      145 |   20826 |  142740 |   504 | N/A   |    74779 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    53 |    13 |      145 |   19350 |  132743 |   464 | N/A   |    73608 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    22 |     6 |       41 |    7319 |   45943 |   288 | 19744 |    26810 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    22 |     5 |       41 |    6128 |   38141 |   248 | N/A   |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    53 |    13 |       41 |    6128 |   38141 |   248 | N/A   |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    22 |     5 |       41 |    6128 |   38141 |   248 | 16515 |    25642 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 53 & 14 & 145 & 20826 & 142740 & 504 & N/A & 74779\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 53 & 13 & 145 & 19350 & 132743 & 464 & N/A & 73608\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 22 & 6 & 41 & 7319 & 45943 & 288 & 19744 & 26810\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & N/A & 25642\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 53 & 13 & 41 & 6128 & 38141 & 248 & N/A & 25642\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 22 & 5 & 41 & 6128 & 38141 & 248 & 16515 & 25642\\ 
\hline
\end{tabular}
\end{table}
#+END_SRC

**** binary size

|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
|                                                                  | demo1 | demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24)          |    66 |    11 |       10 |     507 |     511 |   339 | N/A   |      892 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| CPS, inserted tailcalls (no return instrs) (feb-13-24)           |    66 |    10 |       10 |     478 |     479 |   337 | N/A   |      561 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24)    |    65 |     9 |        9 |     268 |     271 |   330 | 1779  |      793 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| non-CPS, with return instrs, 0ary fast (feb-26-24)               |    65 |     9 |        9 |     242 |     243 |   328 | N/A   |      459 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24)   |    66 |    10 |        9 |     242 |     243 |   328 | N/A   |      459 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-15-24), don't nest if statements (mrch-22-24)      |    65 |     9 |        9 |     244 |     245 |   332 | 1630  |      463 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|
| same as (mrch-22-24), grow mem in separate function (mrch-24-24) |    45 |     6 |        6 |     203 |     203 |   227 | 1128  |      354 |
|------------------------------------------------------------------+-------+-------+----------+---------+---------+-------+-------+----------|


***** latex

#+BEGIN_SRC latex
  \begin{table}
\caption{placeholder caption}
\label{tbl:placeholder-label}
\centering
\begin{tabular}{|l|r|r|r|r|r|r|r|r|}
\hline
 & demo1 & demo2 & list\_sum & vs\_easy & vs\_hard & binom & color & sha\_fast \\\hline
CPS, inserted tailcalls, naive 0ary (CoqPL) (feb-01-24) & 66 & 11 & 10 & 507 & 511 & 339 & N/A & 892\\ 
\hline
CPS, inserted tailcalls (no return instrs) (feb-13-24) & 66 & 10 & 10 & 478 & 479 & 337 & N/A & 561\\ 
\hline
non-CPS, (tailcalls, no return instrs) naive 0ary (feb-07-24) & 65 & 9 & 9 & 268 & 271 & 330 & 1779 & 793\\ 
\hline
non-CPS, with return instrs, 0ary fast (feb-26-24) & 65 & 9 & 9 & 242 & 243 & 328 & N/A & 459\\ 
\hline
same as (feb-26-24), merged update to metacoq 1.3 (mrch-15-24) & 66 & 10 & 9 & 242 & 243 & 328 & N/A & 459\\ 
\hline
same as (mrch-15-24), don't nest if statements (mrch-22-24) & 65 & 9 & 9 & 244 & 245 & 332 & 1630 & 463\\ 
\hline
same as (mrch-22-24), grow mem in separate function (mrch-24-24) & 45 & 6 & 6 & 203 & 203 & 227 & 1128 & 354\\ 
\hline
\end{tabular}
\end{table}

#+END_SRC



* Native (x86)

** Run time

All numbers in milliseconds.

|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
|                                |    demo1 |    demo2 | list_sum | vs_easy | vs_hard | binom |     color | sha_fast |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| CertiCoq C (clang)             |    0.050 |    0.017 |     0.14 |    8.59 |  159.09 | 13.62 |     29.65 |    106.2 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| CertiCoq C (clang -O2)         |    0.038 |    0.012 |    0.077 |    2.64 |   21.61 |  2.75 |     12.33 |    17.10 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| OcaML Extract (ocamlopt)       |    0.003 |    0.002 |     0.01 |    1.01 |    9.68 |  2.57 | N/A[fn:2] |    12.32 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| OcaML Extract (ocamlopt -O2)   |    0.003 |    0.002 |     0.01 |    0.92 |    9.91 |  2.57 | N/A[fn:2] |    12.28 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| Coq-Malfunction (mlf)          |    0.005 |    0.002 |     0.02 |    3.13 |   32.72 |  3.19 |     17.61 |     18.5 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| Coq-Malfunction (mlf -O2)      | 0.000003 | 0.000001 | 0.000010 |    1.20 |   17.56 |  2.55 |      8.56 |    13.13 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| Coq-Malfunction (verified)     |    0.003 |    0.002 |     0.02 |    3.12 |   33.40 |  3.19 |     17.34 |    18.68 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|
| Coq-Malfunction (verified -O2) | 0.000003 | 0.000001 | 0.000010 |    1.19 |   17.48 |  2.57 |      8.63 |    13.13 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-----------+----------|

TODO: Consider adding rust extraction compiled to x86 

** Binary size

|--------------------------------+----------+----------+----------+---------+---------+-------+-------+----------|
|                                |    demo1 |    demo2 | list_sum | vs_easy | vs_hard | binom | color | sha_fast |
|--------------------------------+----------+----------+----------+---------+---------+-------+-------+----------|
| CertiCoq C (clang)             |       75 |       32 |       31 |     641 |     639 |   304 |  1464 |      658 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-------+----------|
| CertiCoq C (clang -O2)         |       44 |       28 |       27 |     226 |     219 |   133 |   564 |      234 |
|--------------------------------+----------+----------+----------+---------+---------+-------+-------+----------|

All numbers in kilobytes.

* Footnotes
[fn:1] Running wasm-opt -O2 on the binary segfaults.

[fn:2] The extracted OcaML code does not type-check. 
